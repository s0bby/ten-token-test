"use strict";(self.webpackChunkten_token_web_2=self.webpackChunkten_token_web_2||[]).push([[651],{42651:function(e,n,t){t.r(n),t.d(n,{OpenloginAdapter:function(){return w},getOpenloginDefaultOptions:function(){return N}});var i=t(74165),r=t(15861),o=t(15671),a=t(43144),s=t(97326),c=t(11752),h=t(61120),u=t(60136),l=t(29388),p=t(84339),g=t(87485),f=t(4942),d=t(79305),v=t.n(d),y=t(62649),C=t.n(y),N=function(e,n){return{adapterSettings:{network:p.dr.MAINNET,clientId:"",uxMode:p.$e.POPUP},chainConfig:e?(0,g.h2)(e,n):void 0,loginSettings:{relogin:!0}}};function P(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function O(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?P(Object(t),!0).forEach((function(n){(0,f.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):P(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var w=function(e){(0,u.Z)(d,e);var n=(0,l.Z)(d);function d(e){var t,i,r,a;(0,o.Z)(this,d),t=n.call(this),(0,f.Z)((0,s.Z)(t),"name",g.rW.OPENLOGIN),(0,f.Z)((0,s.Z)(t),"adapterNamespace",g.yk.MULTICHAIN),(0,f.Z)((0,s.Z)(t),"type",g.hN.IN_APP),(0,f.Z)((0,s.Z)(t),"openloginInstance",null),(0,f.Z)((0,s.Z)(t),"status",g.MP.NOT_READY),(0,f.Z)((0,s.Z)(t),"currentChainNamespace",g.EN.EIP155),(0,f.Z)((0,s.Z)(t),"openloginOptions",void 0),(0,f.Z)((0,s.Z)(t),"loginSettings",{}),(0,f.Z)((0,s.Z)(t),"privKeyProvider",null),C().debug("const openlogin adapter",e);var c=N(null===(i=e.chainConfig)||void 0===i?void 0:i.chainNamespace,null===(r=e.chainConfig)||void 0===r?void 0:r.chainId);if(t.openloginOptions=O(O({clientId:"",network:p.dr.MAINNET},c.adapterSettings),e.adapterSettings||{}),t.loginSettings=O(O({},c.loginSettings),e.loginSettings),null!==(a=e.chainConfig)&&void 0!==a&&a.chainNamespace){var h;t.currentChainNamespace=null===(h=e.chainConfig)||void 0===h?void 0:h.chainNamespace;var u=c.chainConfig?c.chainConfig:{};if(t.chainConfig=O(O({},u),null===e||void 0===e?void 0:e.chainConfig),C().debug("const openlogin chainConfig",t.chainConfig),!t.chainConfig.rpcTarget)throw g.Ty.invalidParams("rpcTarget is required in chainConfig")}return t}return(0,a.Z)(d,[{key:"chainConfigProxy",get:function(){return this.chainConfig?O({},this.chainConfig):null}},{key:"provider",get:function(){var e;return(null===(e=this.privKeyProvider)||void 0===e?void 0:e.provider)||null},set:function(e){throw new Error("Not implemented")}},{key:"init",value:function(){var e=(0,r.Z)((0,i.Z)().mark((function e(n){var t,r,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,c.Z)((0,h.Z)(d.prototype),"checkInitializationRequirements",this).call(this),null!==(t=this.openloginOptions)&&void 0!==t&&t.clientId){e.next=3;break}throw g.Ty.invalidParams("clientId is required before openlogin's initialization");case 3:if(this.chainConfig){e.next=5;break}throw g.Ty.invalidParams("chainConfig is required before initialization");case 5:return this.openloginInstance=new p.ZP(this.openloginOptions),r=(0,p.Gv)(),o=!0,Object.keys(r).length>0&&r.result&&(o=!0),e.next=11,this.openloginInstance.init();case 11:if(this.status=g.MP.READY,this.emit(g.n2.READY,g.rW.OPENLOGIN),e.prev=13,!this.openloginInstance.privKey||!n.autoConnect&&!o){e.next=17;break}return e.next=17,this.connect();case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(13),C().error("Failed to connect with cached openlogin provider",e.t0),this.emit("ERRORED",e.t0);case 23:case"end":return e.stop()}}),e,this,[[13,19]])})));return function(n){return e.apply(this,arguments)}}()},{key:"connect",value:function(){var e=(0,r.Z)((0,i.Z)().mark((function e(n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,c.Z)((0,h.Z)(d.prototype),"checkConnectionRequirements",this).call(this),this.status=g.MP.CONNECTING,this.emit(g.n2.CONNECTING,O(O({},n),{},{adapter:g.rW.OPENLOGIN})),e.prev=3,e.next=6,this.connectWithProvider(n);case 6:return e.abrupt("return",this.provider);case 9:if(e.prev=9,e.t0=e.catch(3),C().error("Failed to connect with openlogin provider",e.t0),this.status=g.MP.READY,this.emit(g.n2.ERRORED,e.t0),null===e.t0||void 0===e.t0||!e.t0.message.includes("user closed popup")){e.next=16;break}throw g.RM.popupClosed();case 16:throw g.RM.connectionError("Failed to login with openlogin");case 17:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(n){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=(0,r.Z)((0,i.Z)().mark((function e(){var n,t=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.length>0&&void 0!==t[0]?t[0]:{cleanup:!1},this.status===g.MP.CONNECTED){e.next=3;break}throw g.RM.notConnectedError("Not connected with wallet");case 3:if(this.openloginInstance){e.next=5;break}throw g.Ty.notReady("openloginInstance is not ready");case 5:return e.next=7,this.openloginInstance.logout();case 7:n.cleanup?(this.status=g.MP.NOT_READY,this.openloginInstance=null,this.privKeyProvider=null):this.status=g.MP.READY,this.emit(g.n2.DISCONNECTED);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getUserInfo",value:function(){var e=(0,r.Z)((0,i.Z)().mark((function e(){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.status===g.MP.CONNECTED){e.next=2;break}throw g.RM.notConnectedError("Not connected with wallet");case 2:if(this.openloginInstance){e.next=4;break}throw g.Ty.notReady("openloginInstance is not ready");case 4:return e.next=6,this.openloginInstance.getUserInfo();case 6:return n=e.sent,e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setAdapterSettings",value:function(e){if(this.status!==g.MP.READY){var n=N();this.openloginOptions=O(O(O({},n.adapterSettings),this.openloginOptions||{}),e)}}},{key:"setChainConfig",value:function(e){(0,c.Z)((0,h.Z)(d.prototype),"setChainConfig",this).call(this,e),this.currentChainNamespace=e.chainNamespace}},{key:"connectWithProvider",value:function(){var e=(0,r.Z)((0,i.Z)().mark((function e(n){var r,o,a,s,c,h,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.chainConfig){e.next=2;break}throw g.Ty.invalidParams("chainConfig is required before initialization");case 2:if(this.openloginInstance){e.next=4;break}throw g.Ty.notReady("openloginInstance is not ready");case 4:if(this.currentChainNamespace!==g.EN.SOLANA){e.next=12;break}return e.next=7,Promise.all([t.e(225),t.e(741),t.e(889),t.e(550),t.e(855)]).then(t.bind(t,15550));case 7:r=e.sent,o=r.SolanaPrivateKeyProvider,this.privKeyProvider=new o({config:{chainConfig:this.chainConfig}}),e.next=21;break;case 12:if(this.currentChainNamespace!==g.EN.EIP155){e.next=20;break}return e.next=15,Promise.all([t.e(225),t.e(741),t.e(562),t.e(403)]).then(t.bind(t,27562));case 15:a=e.sent,s=a.EthereumPrivateKeyProvider,this.privKeyProvider=new s({config:{chainConfig:this.chainConfig}}),e.next=21;break;case 20:throw new Error("Invalid chainNamespace: ".concat(this.currentChainNamespace," found while connecting to wallet"));case 21:if(this.openloginInstance.privKey||!n){e.next=24;break}return e.next=24,this.openloginInstance.login(v()(this.loginSettings,{loginProvider:n.loginProvider},{extraLoginOptions:{login_hint:null===n||void 0===n?void 0:n.login_hint}}));case 24:if(!(c=this.openloginInstance.privKey)){e.next=36;break}if(this.currentChainNamespace!==g.EN.SOLANA){e.next=32;break}return e.next=29,Promise.all([t.e(889),t.e(508)]).then(t.bind(t,80834));case 29:h=e.sent,u=h.getED25519Key,c=u(c).sk.toString("hex");case 32:return e.next=34,this.privKeyProvider.setupProvider(c);case 34:this.status=g.MP.CONNECTED,this.emit(g.n2.CONNECTED,{adapter:g.rW.OPENLOGIN,reconnected:!n});case 36:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()}]),d}(g.J5)}}]);